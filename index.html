<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>–í–≤–µ–¥–µ–Ω–Ω—è –≤–∞–ª—é—Ç</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;600;700;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
  <link rel="manifest" href="manifest.json">
  <link rel="icon" href="/icons/icon-192.png">
  <meta name="theme-color" content="#121212">
</head>
<body>
  <div class="app-container">
    <!-- –í–∏–±—ñ—Ä —Ç–∞–±–ª–∏—Ü—ñ -->
    <div class="controls">
      <label for="spreadsheetSelect">–¢–∞–±–ª–∏—Ü—è:</label>
      <select id="spreadsheetSelect">
        <option value="1--sn71S8Mb6c2U91wpTF6s8_WWITRNgaqvE30MT4Sh8">–û—Å–Ω–æ–≤–Ω–∞ —Ç–∞–±–ª–∏—Ü—è</option>
        <!-- –î–æ–¥–∞–π—Ç–µ —ñ–Ω—à—ñ ID —Ç–∞–±–ª–∏—Ü—å —Ç—É—Ç -->
      </select>
    </div>
    <!-- –í–∫–ª–∞–¥–∫–∞ –≤–∞–ª—é—Ç -->
    <div id="tab-currency" class="tab-content active">
      <div class="form-container">
        <div class="form-header">
          <select id="operation">
            <option value="buy">–ö—É–ø—ñ–≤–ª—è</option>
            <option value="sell">–ü—Ä–æ–¥–∞–∂</option>
          </select>
          <select id="dateInput">
            <option value="01">01</option>
            <option value="02">02</option>
            <option value="03">03</option>
            <option value="04">04</option>
            <option value="05">05</option>
            <option value="06">06</option>
            <option value="07">07</option>
            <option value="08">08</option>
            <option value="09">09</option>
            <option value="10">10</option>
            <option value="11">11</option>
            <option value="12">12</option>
            <option value="13">13</option>
            <option value="14">14</option>
            <option value="15">15</option>
            <option value="16">16</option>
            <option value="17">17</option>
            <option value="18">18</option>
            <option value="19">19</option>
            <option value="20">20</option>
            <option value="21">21</option>
            <option value="22">22</option>
            <option value="23">23</option>
            <option value="24">24</option>
            <option value="25">25</option>
            <option value="26">26</option>
            <option value="27">27</option>
            <option value="28">28</option>
            <option value="29">29</option>
            <option value="30">30</option>
            <option value="31">31</option>
          </select>
        </div>

        <table class="currency-table">
          <thead>
            <tr>
              <th>–í–∞–ª—é—Ç–∞</th>
              <th>–°—É–º–∞</th>
              <th>–ö—É—Ä—Å</th>
              <th>–ì–†–ù</th>
            </tr>
          </thead>
          <tbody id="currencyTableBody"></tbody>
          <tfoot>
            <tr class="total-row">
              <td colspan="2"><b>–†–ê–ó–û–ú –ì–†–ù</b></td>
              <td colspan="2"><input type="text" id="total_grn" readonly></td>
            </tr>
          </tfoot>
        </table>

        <div class="loader" id="loader"></div>
        
        <div class="action-buttons">
          <button type="button" id="saveButton">–ó–±–µ—Ä–µ–≥—Ç–∏</button>
          <button type="button" id="fetchButton">–ü—ñ–¥—Ç—è–≥–Ω—É—Ç–∏</button>
        </div>

        <div class="message-list" id="messageList"></div>

        <div id="confirmModal" class="modal">
          <div class="modal-content">
            <div class="modal-header">
              <h3>–ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –æ–ø–µ—Ä–∞—Ü—ñ—ó</h3>
              <div id="modalPreviewHeader"></div>
              <hr>
            </div>
            <table class="modal-table">
              <thead>
                <tr>
                  <th>–í–∞–ª—é—Ç–∞</th>
                  <th>–°—É–º–∞</th>
                  <th>–ö—É—Ä—Å</th>
                  <th>–ì–†–ù</th>
                </tr>
              </thead>
              <tbody id="modalTableBody"></tbody>
              <tfoot>
                <tr class="total-row">
                  <td colspan="3"><b>–†–ê–ó–û–ú –ì–†–ù</b></td>
                  <td><input type="text" id="modalTotalGrn" readonly></td>
                </tr>
              </tfoot>
            </table>
            <div class="modal-buttons">
              <button id="cancelButton" class="cancel-btn">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
              <button id="confirmButton" class="confirm-btn">–ü—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏</button>
            </div>
          </div>
        </div>

        <div id="pointModal" class="modal">
          <div class="modal-content">
            <div class="modal-header">
              <h3>–í–∏–±–µ—Ä—ñ—Ç—å —Ç–æ—á–∫—É</h3>
              <hr>
            </div>
            <select id="pointSelect">
              <option value="point1">U6KA_Inkas</option>
              <option value="point2">KASP_Inkas</option>
              <option value="point3">GL_Inkas</option>
              <option value="point4">TAR_Inkas</option>
              <option value="point5">4UDO_Inkas</option>
              <option value="point6">KR_Inkas</option>
              <option value="point7">BAZAR_Inkas</option>
              <option value="point8">BUBNA_Inkas</option>
            </select>
            <div class="modal-buttons">
              <button onclick="closePointModal()" class="cancel-btn">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
              <button id="fetchDataButton" onclick="fetchPointData()">–ü—ñ–¥—Ç—è–≥–Ω—É—Ç–∏ –¥–∞–Ω—ñ</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- –í–∫–ª–∞–¥–∫–∞ —ñ—Å—Ç–æ—Ä—ñ—ó -->
    <div id="tab-history" class="tab-content">
      <div class="history-container">
        <h2>–Ü—Å—Ç–æ—Ä—ñ—è –æ–ø–µ—Ä–∞—Ü—ñ–π</h2>
        <div class="loader" id="historyLoader"></div>
        <div id="historyContent"></div>
        <div class="message-list" id="historyMessageList"></div>

        <div id="undoModal" class="modal">
          <div class="modal-content">
            <div class="modal-header">
              <h3>–°–∫–∞—Å—É–≤–∞–Ω–Ω—è –æ–ø–µ—Ä–∞—Ü—ñ—ó</h3>
              <div id="undoPreviewHeader"></div>
              <hr>
            </div>
            <table class="modal-table">
              <thead>
                <tr>
                  <th>–í–∞–ª—é—Ç–∞</th>
                  <th>–°—É–º–∞</th>
                  <th>–ö—É—Ä—Å</th>
                  <th>–ß–∞—Å</th>
                  <th>–ì–†–ù</th>
                </tr>
              </thead>
              <tbody id="undoTableBody"></tbody>
            </table>
            <div class="modal-buttons">
              <button id="undoCancelButton" class="cancel-btn">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
              <button id="undoConfirmButton" class="danger-btn">–í–∏–¥–∞–ª–∏—Ç–∏</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- –í–∫–ª–∞–¥–∫–∞ –≤–∏—Ç—Ä–∞—Ç -->
    <div id="tab-expenses" class="tab-content">
      <div class="expenses-container">
        <h2>–í–∏—Ç—Ä–∞—Ç–∏</h2>
        <table class="expenses-table">
          <thead>
            <tr>
              <th>–ö–∞—Ç–µ–≥–æ—Ä—ñ—è</th>
              <th>–°—É–º–∞ (–ì–†–ù)</th>
            </tr>
          </thead>
          <tbody id="expensesTableBody"></tbody>
        </table>
        <div class="loader" id="expensesLoader"></div>
        <div class="action-buttons">
          <button type="button" id="saveExpensesButton">–ó–±–µ—Ä–µ–≥—Ç–∏ –≤–∏—Ç—Ä–∞—Ç–∏</button>
        </div>
        <div class="message-list" id="expensesMessageList"></div>
      </div>
    </div>

    <!-- –í–∫–ª–∞–¥–∫–∞ –∑–∞–ª–∏—à–∫—ñ–≤ -->
    <div id="tab-balances" class="tab-content">
      <div class="balances-container">
        <h2>–ó–∞–ª–∏—à–∫–∏ –≤–∞–ª—é—Ç</h2>
        <table class="balances-table">
          <thead>
            <tr>
              <th>–í–∞–ª—é—Ç–∞</th>
              <th>–ó–∞–ª–∏—à–æ–∫</th>
            </tr>
          </thead>
          <tbody id="balancesTableBody"></tbody>
        </table>
        <div class="loader" id="balancesLoader"></div>
      </div>
    </div>
  </div>

  <!-- –ù–∞–≤—ñ–≥–∞—Ü—ñ—è –≤–∫–ª–∞–¥–æ–∫ -->
  <div class="tabs-container">
    <div class="tab active" data-tab="tab-currency">–í–∞–ª—é—Ç–∞</div>
    <div class="tab" data-tab="tab-history">–Ü—Å—Ç–æ—Ä—ñ—è</div>
    <div class="tab" data-tab="tab-expenses">–í–∏—Ç—Ä–∞—Ç–∏</div>
    <div class="tab" data-tab="tab-balances">–ó–∞–ª–∏—à–∫–∏</div>
    <div class="theme-switcher" onclick="cycleTheme()">üåì</div>
  </div>

  <script src="script.js"></script>
</body>
</html>